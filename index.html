<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">

<!--åŸºæœ¬ SEO -->
<title>æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±ï½œSmart Trash AI</title>
<meta name="description" content="æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±ï¼šé€é AI å½±åƒè¾¨è­˜å”åŠ©åˆ¤æ–·ç´™é¡ã€å¡‘è† ã€é‡‘å±¬ã€ç»ç’ƒã€ç´™é¤å…·èˆ‡ä¸€èˆ¬åƒåœ¾ï¼Œé©åˆç’°å¢ƒæ•™è‚²ã€æ•™å­¸ç¤ºç¯„èˆ‡ AI å°ˆé¡Œå±•ç¤ºçš„äº’å‹•å¼åƒåœ¾åˆ†é¡ç¶²ç«™ã€‚">
<meta name="keywords" content="æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±, AIåƒåœ¾åˆ†é¡, åƒåœ¾å½±åƒè¾¨è­˜, æ™ºèƒ½åˆ†é¡, AIå°ˆé¡Œ, ç’°å¢ƒæ•™è‚², Smart Trash AI">
<meta name="robots" content="index, follow">
<meta name="author" content="Smart Trash AI">

<!-- æœ€ä½³åŒ– -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">


<!-- ğŸ”§ å¯æ„›æ’ç•«é¢¨ CSSï¼ˆä½ ç›®å‰çš„æ¨£å¼ï¼‰ -->
<style>
   ï¼ˆé€™è£¡æ”¾ä½ çš„å…¨éƒ¨ CSSï¼‰
</style>

</head>


<style>
/* ------------------------
   ğŸŒ¿ å…¨åŸŸè¨­è¨ˆï¼šå¯æ„›æ’ç•«é¢¨
------------------------- */
* { box-sizing: border-box; }
body {
  font-family: "Noto Sans TC", sans-serif;
  background: #e8f5e9;
  margin: 0;
  padding: 0;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  height: 100vh;
  overflow-x: hidden;
}

/* ------------------------
   ğŸŒ¿ å°é¢é ï¼ˆå¯æ„›æ’ç•«é¢¨ï¼‰
------------------------- */
#cover {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  justify-content: center; align-items: center;
  background: linear-gradient(135deg, #d0f8ce, #c8e6c9);
  z-index: 3;
  animation: fadeIn 1s ease forwards;
}

#cover img {
  width: 260px;
  margin-bottom: 20px;
  filter: drop-shadow(0 0 12px rgba(76,175,80,0.5));
  animation: float 3s ease-in-out infinite;
}

#cover button {
  background: #66bb6a;
  color: white;
  border: none;
  padding: 16px 40px;
  font-size: 1.3rem;
  border-radius: 40px;
  cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.2);
  transition: 0.3s;
}
#cover button:hover { transform: scale(1.06); }

/* ------------------------
   ğŸŒ¿ ä¸»ç•«é¢ï¼ˆå¯æ„› APP é¢¨ï¼‰
------------------------- */
#main {
  width: 100%;
  max-width: 480px;
  margin-top: 0;
  display: none;
  flex-direction: column;
  align-items: center;
  text-align: center;
}

/* ------------------------
   ğŸŒ¿ å›ºå®šé ‚éƒ¨æ¨™é¡Œåˆ—
------------------------- */
#header {
  width: 100%;
  background: #66bb6a;
  color: white;
  text-align: center;
  font-size: 1.6rem;
  font-weight: bold;
  padding: 14px 0;
  position: fixed;
  top: 0;
  z-index: 5;
  box-shadow: 0 3px 10px rgba(0,0,0,0.2);
}

/* ------------------------
   ğŸŒ¿ æ”å½±æ©Ÿå€
------------------------- */
#cameraBox {
  margin-top: 80px;
  background: white;
  padding: 12px 12px 20px;
  border-radius: 18px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
}

video {
  border-radius: 16px;
  width: 340px;
}

/* ------------------------
   ğŸŒ¿ åœ“å½¢æ‹ç…§æŒ‰éˆ•ï¼ˆå¯æ„›å½ˆè·³ï¼‰
------------------------- */
#snap {
  width: 85px;
  height: 85px;
  background: #81c784;
  border-radius: 50%;
  border: none;
  margin-top: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.25);
  font-size: 1.1rem;
  color: white;
  cursor: pointer;
  transition: 0.15s;
}
#snap:active { transform: scale(0.9); }

/* ------------------------
   ğŸŒ¿ è¾¨è­˜çµæœå¡ç‰‡ï¼ˆä¸­å‹ã€æµ®èµ·ä¾†ï¼‰
------------------------- */
#resultCard {
  margin-top: 20px;
  background: white;
  width: 90%;
  max-width: 360px;
  border-radius: 18px;
  padding: 18px;
  text-align: center;
  display: none;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  animation: pop 0.3s ease;
  font-size: 1.2rem;
  font-weight: bold;
}

/* å¡ç‰‡é¡è‰² */
.recycle { border-left: 8px solid #66bb6a; }
.trash { border-left: 8px solid #9e9e9e; }
.hazard { border-left: 8px solid #e57373; }

/* å°æç¤ºå¡ */
#tip {
  margin-top: 10px;
  background: #f1f8e9;
  padding: 12px 16px;
  border-radius: 14px;
  display: none;
  width: 85%;
  max-width: 360px;
  border-left: 5px solid #81c784;
  color: #33691e;
  font-size: 0.95rem;
  line-height: 1.5;
}

/* å‹•ç•« */
@keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
@keyframes float { 0%,100%{transform:translateY(0);}50%{transform:translateY(-8px);} }
@keyframes pop { from{transform:scale(0.9);} to{transform:scale(1);} }
</style>
</head>
<body>
<!-- éš±è—æ¨™é¡Œï¼ˆSEO friendlyï¼‰ -->
<h1 style="display:none;">æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ± AI åƒåœ¾è¾¨è­˜</h1>

<!-- å°é¢é  -->
<div id="cover">
  <img src="model/LOGO.png" alt="LOGO">
  <button onclick="enterSystem()">é€²å…¥ç³»çµ±</button>
</div>

<!-- ä¸»ç•«é¢ -->
<div id="main">
  <div id="header">ğŸŒ æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±</div>

  <div id="cameraBox">
    <video id="video" autoplay playsinline muted></video>
    <button id="snap" disabled>æ‹ç…§</button>
  </div>

  <div id="resultCard"></div>
  <div id="tip"></div>
</div>

<!-- Tensorflow / Teachable Machine -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image/dist/teachablemachine-image.min.js"></script>

<script>
const video = document.getElementById('video');
const snapBtn = document.getElementById('snap');
const cover = document.getElementById('cover');
const main = document.getElementById('main');
const resultCard = document.getElementById('resultCard');
const tipBox = document.getElementById('tip');

let model;
let currentStream = null;

/* -----------------------------
   ğŸŒ¿ å°é¢ â†’ å•Ÿå‹•ç³»çµ±
------------------------------ */
async function enterSystem() {
  stopCamera();
  cover.style.animation = "fadeOut 1s ease forwards";

  setTimeout(() => {
    cover.style.display = "none";
    main.style.display = "flex";
    loadCameraAndModel();
  }, 900);
}

/* -----------------------------
   ğŸŒ¿ å›åˆ°å°é¢ä¸¦é‡æ–°æ•´ç†ï¼ˆè®“ä½¿ç”¨è€…å¯é‡æ–°é¸æ“‡æ¬Šé™ï¼‰
------------------------------ */
function backToCover(message) {
  stopCamera();
  main.style.display = "none";
  cover.style.display = "flex";

  alert(message + "\nè«‹å…è¨±ç›¸æ©Ÿå¾Œå†é‡æ–°é»é¸ã€é€²å…¥ç³»çµ±ã€ã€‚");

  setTimeout(() => {
    location.reload();  // è‡ªå‹•åˆ·æ–°é é¢
  }, 600);
}

/* -----------------------------
   ğŸŒ¿ é—œé–‰ç›¸æ©Ÿ
------------------------------ */
function stopCamera() {
  if (currentStream) {
    currentStream.getTracks().forEach(track => track.stop());
    currentStream = null;
  }
  video.srcObject = null;
}

/* -----------------------------
   ğŸŒ¿ é–‹å•Ÿç›¸æ©Ÿ & è¼‰å…¥æ¨¡å‹
------------------------------ */
async function loadCameraAndModel() {
  try {
    currentStream = await navigator.mediaDevices.getUserMedia({ 
      video: { facingMode: "environment" } 
    });
    video.srcObject = currentStream;
  } catch (err) {
    console.error("ç›¸æ©Ÿå¤±æ•—ï¼š", err);
    backToCover("âš ï¸ ç„¡æ³•é–‹å•Ÿç›¸æ©Ÿæˆ–æœªå…è¨±ç›¸æ©Ÿæ¬Šé™");
    return;
  }

  resultCard.style.display = "block";
  resultCard.className = "trash";
  resultCard.innerText = "â³ æ¨¡å‹è¼‰å…¥ä¸­...";

  try {
    const modelURL = "./model/model.json";
    const metadataURL = "./model/metadata.json";
    model = await window.tmImage.load(modelURL, metadataURL);

    snapBtn.disabled = false;
    resultCard.className = "recycle";
    resultCard.innerText = "âœ… æ¨¡å‹è¼‰å…¥å®Œæˆï¼Œå¯ä»¥é–‹å§‹æ‹ç…§åˆ†é¡ï¼";
  } catch (err) {
    console.error("æ¨¡å‹è¼‰å…¥å¤±æ•—ï¼š", err);
    backToCover("âŒ æ¨¡å‹è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèª model è³‡æ–™å¤¾æ˜¯å¦æ­£ç¢ºã€‚");
  }
}

/* -----------------------------
   ğŸŒ¿ å°çŸ¥è­˜è³‡æ–™åº«ï¼ˆå¯è‡ªè¡Œæ“´å……ï¼‰
------------------------------ */
const tips = {
  "å¡‘è† é¡": "ğŸ’¡ å¯¶ç‰¹ç“¶å£“æ‰å†å›æ”¶ï¼Œå¯æ¸›å°‘åƒåœ¾é«”ç©ï¼›å¦‚æœ‰æ¶²é«”è¨˜å¾—å…ˆå€’æ‰ï¼",
  "ç´™é¡": "ğŸ§» ç´™å¼µä¿æŒä¹¾ç‡¥ï¼Œé¿å…æ²¹æ±¡èˆ‡å¡‘è† è†œã€‚",
  "é‡‘å±¬é¡": "ğŸ”§ éµé‹ç½å£“æ‰å¾Œå†å›æ”¶ï¼Œå¯ç¯€çœç©ºé–“ã€‚",
  "ç»ç’ƒé¡": "ğŸ¾ ç ´æç»ç’ƒè«‹ç”¨ç´™åŒ…å¥½å†æŠ•å…¥ã€‚",
  "ç´™é¤å…·": "ğŸ½ï¸ è‹¥ç´™é¤å…·æ²¾æ²¹æ±¡ï¼Œè«‹ä¸Ÿä¸€èˆ¬åƒåœ¾ã€‚",
  "ä¸€èˆ¬åƒåœ¾": "ğŸš® è«‹å†æ¬¡ç¢ºèªæ˜¯å¦ä»æœ‰å¯å›æ”¶éƒ¨åˆ†ã€‚",
  "æœ‰å®³åƒåœ¾": "â˜ ï¸ é›»æ± ã€ç‡ˆç®¡ç­‰éœ€ç‰¹åˆ¥å›æ”¶è™•ç†ã€‚"
};

/* -----------------------------
   ğŸŒ¿ æ‹ç…§ + åˆ†é¡
------------------------------ */
snapBtn.addEventListener("click", async () => {
  // è½‰æˆ canvasï¼ˆä½†ä¸é¡¯ç¤ºï¼‰
  const canvas = document.createElement("canvas");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  const ctx = canvas.getContext("2d");
  ctx.drawImage(video, 0, 0);

  tipBox.style.display = "none";

  if (!model) return;

  try {
    const prediction = await model.predict(canvas);
    let best = prediction[0];

    prediction.forEach(p => {
      if (p.probability > best.probability) best = p;
    });

    let cssClass = "trash", icon = "ğŸ—‘ï¸";

    if (best.className.includes("å¯å›æ”¶") || best.className.includes("è³‡æºå›æ”¶")) {
      cssClass = "recycle"; icon = "â™»ï¸";
    } else if (best.className.includes("æœ‰å®³")) {
      cssClass = "hazard"; icon = "â˜ ï¸";
    }

    resultCard.className = cssClass;
    resultCard.style.display = "block";
    resultCard.innerHTML =
      `${icon} <br> <b>${best.className}</b><br><small>${(best.probability * 100).toFixed(2)}%</small>`;

    // é¡¯ç¤ºåˆ†é¡æç¤º
    for (let key in tips) {
      if (best.className.includes(key)) {
        tipBox.innerText = tips[key];
        tipBox.style.display = "block";
        break;
      }
    }

  } catch (err) {
    console.error("è¾¨è­˜éŒ¯èª¤ï¼š", err);
    resultCard.className = "hazard";
    resultCard.innerText = "âš ï¸ åˆ†é¡éŒ¯èª¤ï¼š" + err.message;
  }
});
</script>
</body>
</html>
