<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">

<!-- SEO å¼·åŒ–å€ -->
<title>æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±ï½œSmart Trash AI</title>

<meta name="description" content="æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±ï¼šé€é AI å½±åƒè¾¨è­˜å”åŠ©åˆ¤æ–·ç´™é¡ã€å¡‘è† ã€é‡‘å±¬ã€ç»ç’ƒã€ç´™é¤å…·èˆ‡ä¸€èˆ¬åƒåœ¾ï¼Œé©åˆç’°å¢ƒæ•™è‚²ã€æ•™å­¸ç¤ºç¯„èˆ‡ AI å°ˆé¡Œå±•ç¤ºçš„äº’å‹•å¼åƒåœ¾åˆ†é¡ç¶²ç«™ã€‚">
<meta name="keywords" content="æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±, AIåƒåœ¾åˆ†é¡, åƒåœ¾å½±åƒè¾¨è­˜, æ™ºèƒ½åˆ†é¡, AIå°ˆé¡Œ, ç’°å¢ƒæ•™è‚², Smart Trash AI">
<meta name="robots" content="index, follow">
<meta name="author" content="Smart Trash AI">

<!-- è®“ Google èƒ½æ­£ç¢ºæŠ“å– mobile è¨­å®š -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- SEO å¼·åŒ–å€ -->

<style>
* { box-sizing: border-box; transition: all 0.6s ease; }
body {
  font-family: "Noto Sans TC", sans-serif;
  background: linear-gradient(135deg, #e0f7fa, #e8f5e9);
  margin: 0; padding: 0;
  display: flex; justify-content: center; align-items: center;
  height: 100vh; overflow: hidden;
}

/* å°é¢ */
#cover {
  position: absolute; inset: 0;
  display: flex; flex-direction: column; justify-content: center; align-items: center;
  background: radial-gradient(circle at center, #C1FFC1 0%, #B4EEB4 50%, #9BCD9B 100%);
  z-index: 2; animation: fadeIn 1.2s ease forwards;
}
#cover img { width: 280px; margin-bottom: 25px; filter: drop-shadow(0 0 15px rgba(76,175,80,0.8)); animation: float 3s ease-in-out infinite; }
#cover button {
  background: #2e7d32; color: white; border: none; padding: 14px 36px;
  font-size: 1.2rem; font-weight: bold; border-radius: 30px; cursor: pointer;
  box-shadow: 0 6px 15px rgba(0,0,0,0.3); transition: all 0.3s ease;
}
#cover button:hover { background: #43a047; transform: scale(1.05); }

/* ä¸»ç•«é¢ */
#main {
  opacity: 0; transform: translateY(50px); display: none;
  flex-direction: column; align-items: center; text-align: center; width: 100%;
  animation: slideUp 1s ease forwards;
}
#header {
  width: 100%; background: #2e7d32; color: white; text-align: center;
  font-size: 1.8rem; font-weight: bold; padding: 18px 0;
  box-shadow: 0 3px 10px rgba(0,0,0,0.2); letter-spacing: 2px;
}
h2 { margin-top: 10px; color: #2e7d32; font-size: 1.6rem; }

video, canvas {
  border: 3px solid #a5d6a7; border-radius: 12px; margin: 10px 0;
}
button {
  background: #66bb6a; color: white; border: none;
  padding: 12px 24px; font-size: 1rem; font-weight: bold;
  border-radius: 25px; cursor: pointer; transition: all 0.3s ease;
}
button:hover {
  background: #43a047; transform: translateY(-2px);
  box-shadow: 0 6px 12px rgba(0,0,0,0.2);
}
#result {
  margin-top: 20px; font-size: 1.2rem; font-weight: bold;
  padding: 12px 20px; border-radius: 12px; display: none;
  min-width: 320px; text-align: center;
}
#tip {
  margin-top: 12px;
  font-size: 1rem;
  background: #f1f8e9;
  border-left: 5px solid #81c784;
  color: #33691e;
  padding: 10px 16px;
  border-radius: 8px;
  display: none;
  max-width: 360px;
  line-height: 1.5;
  text-align: left;
}

.recycle { background: #c8e6c9; color: #1b5e20; }
.trash { background: #eeeeee; color: #424242; }
.hazard { background: #ffcdd2; color: #b71c1c; }

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes fadeOut { from { opacity: 1; } to { opacity: 0; transform: scale(1.05); } }
@keyframes slideUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
@keyframes float { 0%,100%{transform:translateY(0);}50%{transform:translateY(-10px);} }
</style>
</head>
<body>

<!-- Google è®€å–ç¶²ç«™ -->
<h1 style="display:none;">æ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±ï¼ˆSmart Trash AIï¼‰</h1>

<!-- å°é¢ -->
<div id="cover">
  <img src="model/LOGO.png" alt="LOGO">

  <!-- Google ç”¨ -->
  <p style="max-width:420px; text-align:center; font-size:0.9rem; color:#2e7d32; margin-bottom:18px;">
    æœ¬ç³»çµ±åˆ©ç”¨ AI å½±åƒè¾¨è­˜å”åŠ©åƒåœ¾åˆ†é¡ï¼Œæ”¯æ´ç´™é¡ã€å¡‘è† ã€é‡‘å±¬ã€ç»ç’ƒã€ç´™é¤å…·èˆ‡ä¸€èˆ¬åƒåœ¾ï¼Œ
    é©åˆèª²å ‚å±•ç¤ºã€æ•™å­¸ç¤ºç¯„èˆ‡ç’°å¢ƒæ•™è‚²ã€‚
  </p>

  <button onclick="enterSystem()">é€²å…¥ç³»çµ±</button>
</div>

<!-- ä¸»ç•«é¢ -->
<div id="main">
  <div id="header">ğŸŒæ™ºæ…§åƒåœ¾åˆ†é¡ç³»çµ±</div>
  <h2>ğŸ“· é–‹å•Ÿé¡é ­æ‹ç…§ä¸¦åˆ†é¡</h2>
  <video id="video" width="360" height="480" autoplay playsinline muted></video>
  <br>
  <button id="snap" disabled>æ‹ç…§ä¸¦åˆ†é¡</button>
  <canvas id="canvas" width="360" height="480"></canvas>
  <div id="result"></div>
  <div id="tip"></div>
</div>

<!-- æ¨¡å‹èˆ‡ä¸»ç¨‹å¼ -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image/dist/teachablemachine-image.min.js"></script>
<script>
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const context = canvas.getContext('2d');
const resultBox = document.getElementById('result');
const tipBox = document.getElementById('tip');
const snapBtn = document.getElementById("snap");
const cover = document.getElementById('cover');
const main = document.getElementById('main');
let model;
let currentStream = null;

// å°é¢ â†’ ä¸»ç•«é¢
async function enterSystem() {
  stopCamera();
  cover.style.animation = "fadeOut 1s ease forwards";
  setTimeout(() => {
    cover.style.display = "none";
    main.style.display = "flex";
    main.style.opacity = "1";
    loadCameraAndModel();
  }, 1000);
}

// å›åˆ°å°é¢ + è‡ªå‹•åˆ·æ–°
function backToCover(message) {
  stopCamera();
  main.style.display = "none";
  cover.style.display = "flex";
  cover.style.animation = "fadeIn 1s ease forwards";
  alert(message + "\nè«‹å…è¨±ä½¿ç”¨ç›¸æ©Ÿå†è©¦ä¸€æ¬¡ã€‚");
  // é‡æ–°æ•´ç†é é¢ï¼Œè®“ä½¿ç”¨è€…å¯é‡æ–°é¸æ“‡æ¬Šé™
  setTimeout(() => {
    location.reload();
  }, 1000);
}

// é—œé–‰æ”å½±æ©Ÿ
function stopCamera() {
  if (currentStream) {
    currentStream.getTracks().forEach(track => track.stop());
    currentStream = null;
  }
  video.srcObject = null;
}

// é–‹å•Ÿé¡é ­èˆ‡è¼‰å…¥æ¨¡å‹
async function loadCameraAndModel() {
  try {
    currentStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
    video.srcObject = currentStream;
  } catch (err) {
    console.error("é¡é ­å­˜å–å¤±æ•—ï¼š", err);
    backToCover("âš ï¸ ç„¡æ³•é–‹å•Ÿé¡é ­æˆ–æœªå…è¨±ç›¸æ©Ÿæ¬Šé™");
    return;
  }

  resultBox.style.display = "block";
  resultBox.className = "trash";
  resultBox.innerText = "â³ æ¨¡å‹è¼‰å…¥ä¸­...";

  try {
    const modelURL = "./model/model.json";
    const metadataURL = "./model/metadata.json";
    model = await window.tmImage.load(modelURL, metadataURL);
    snapBtn.disabled = false;
    resultBox.className = "recycle";
    resultBox.innerText = "âœ… æ¨¡å‹è¼‰å…¥å®Œæˆï¼Œå¯ä»¥é–‹å§‹æ‹ç…§åˆ†é¡ï¼";
  } catch (err) {
    console.error("æ¨¡å‹è¼‰å…¥å¤±æ•—ï¼š", err);
    backToCover("âŒ æ¨¡å‹è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¢ºèª model è³‡æ–™å¤¾æ˜¯å¦æ­£ç¢ºã€‚");
  }
}

// å°æç¤ºè³‡æ–™åº«
const tips = {
  "å¡‘è† é¡": "ğŸ’¡ å¯¶ç‰¹ç“¶å£“æ‰å†å›æ”¶ï¼Œå¯æ¸›å°‘åƒåœ¾é«”ç©ï¼›å¦‚æœ‰æ¶²é«”è¨˜å¾—å…ˆå€’æ‰ï¼",
  "ç´™é¡": "ğŸ§» å›æ”¶å‰è«‹ä¿æŒä¹¾ç‡¥ï¼Œé¿å…æ²¹æ±¡æˆ–å¡‘è† è†œã€‚",
  "é‡‘å±¬é¡": "ğŸ”§ éµé‹ç½è«‹å£“æ‰ï¼Œä¸¦ç¢ºä¿å…§å®¹ç‰©æ¸…ç©ºã€‚",
  "ç»ç’ƒé¡": "ğŸ¾ è«‹å°å¿ƒæ¬é‹ï¼Œç ´æç»ç’ƒè«‹å¦¥å–„åŒ…è£¹å¾ŒæŠ•æ”¾ã€‚",
  "ç´™é¤å…·": "ğŸ½ï¸ è‹¥æ²¾æ²¹æ±¡ï¼Œè«‹ç•¶ä½œä¸€èˆ¬åƒåœ¾è™•ç†ã€‚",
  "ä¸€èˆ¬åƒåœ¾": "ğŸš® è«‹ç¢ºèªç„¡æ³•å›æ”¶å¾Œå†æŠ•æ”¾ï¼Œä»¥æ¸›å°‘æ±¡æŸ“ã€‚",
  "æœ‰å®³åƒåœ¾": "â˜ ï¸ å«é›»æ± ã€ç‡ˆç®¡ç­‰æ‡‰äº¤ç”±å°ˆé–€å›æ”¶è™•ç†ã€‚"
};

// æ‹ç…§èˆ‡åˆ†é¡
snapBtn.addEventListener("click", async () => {
  context.drawImage(video, 0, 0, canvas.width, canvas.height);
  tipBox.style.display = "none";

  if (!model) {
    resultBox.style.display = "block";
    resultBox.className = "hazard";
    resultBox.innerText = "âš ï¸ æ¨¡å‹å°šæœªè¼‰å…¥å®Œæˆ";
    return;
  }

  try {
    const prediction = await model.predict(canvas);
    let best = prediction[0];
    prediction.forEach(p => {
      if (p.probability > best.probability) best = p;
    });

    let cssClass = "trash", icon = "ğŸ—‘ï¸";
    if (best.className.includes("å¯å›æ”¶") || best.className.includes("è³‡æºå›æ”¶")) {
      cssClass = "recycle"; icon = "â™»ï¸";
    } else if (best.className.includes("æœ‰å®³")) {
      cssClass = "hazard"; icon = "â˜ ï¸";
    }

    resultBox.className = cssClass;
    resultBox.style.display = "block";
    resultBox.innerText = `${icon} åˆ†é¡çµæœï¼š${best.className} (${(best.probability*100).toFixed(2)}%)`;

    // é¡¯ç¤ºåˆ†é¡æç¤º
    for (let key in tips) {
      if (best.className.includes(key)) {
        tipBox.innerText = tips[key];
        tipBox.style.display = "block";
        break;
      }
    }

  } catch (err) {
    console.error("åˆ†é¡å¤±æ•—ï¼š", err);
    resultBox.style.display = "block";
    resultBox.className = "hazard";
    resultBox.innerText = "âš ï¸ åˆ†é¡éç¨‹ç™¼ç”ŸéŒ¯èª¤ï¼š" + err.message;
  }
});
</script>
</body>
</html>

